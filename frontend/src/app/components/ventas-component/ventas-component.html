<p-toast></p-toast>
<div
  class="grid grid-cols-1 gap-4 h-fit {{
    optionSelected() === 'Mis Ventas' ? '' : 'hidden md:block'
  }}"
>
  <h2 class="text-2xl font-semibold pt-6">Mis Ventas</h2>
  <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
    @for (product of products()?.datas; track $index) {
    <div
      class="p-6 border border-surface-200 dark:border-surface-700 bg-surface-0 dark:bg-surface-900 rounded flex flex-col"
    >
      <div class="bg-surface-50 flex justify-center rounded p-4">
        <div class="relative mx-auto">
          <img
            class="rounded w-full"
            [src]="product.image"
            [alt]="product.name"
            style="max-width: 300px"
          />
        </div>
      </div>
      <div class="pt-6">
        <div class="flex flex-row justify-between products-start gap-2">
          <div>
            <span
              class="font-medium text-surface-500 dark:text-surface-400 text-sm"
              >{{ product.category }}</span
            >
            <div class="text-lg font-medium mt-1">{{ product.name }}</div>
          </div>
        </div>
        <div class="flex flex-col gap-6 mt-6">
          @if (product.forSale) {

          <span class="text-2xl font-semibold">€{{ product.price }}</span>
          <div class="grid grid-cols-2 gap-2">
            <button
              label="Eliminar"
              severity="danger"
              pButton
              icon="pi pi-trash"
              (click)="deleteProduct(product.id)"
            ></button>
            <button
              label="Editar"
              pButton
              icon="pi pi-pencil"
              severity="contrast"
              (click)="editProduct(product)"
            ></button>

            <p-dialog
              header="Editar Producto"
              [modal]="true"
              [(visible)]="visible"
              [style]="{ width: '25rem' }"
            >
              <span class="p-text-secondary block mb-8"
                >Actualiza la informacion de tu producto.</span
              >
              <form [formGroup]="form" (ngSubmit)="updateProduct(product.id)">
                <div class="flex items-center gap-4 mb-4">
                  <label
                    for="name"
                    class="font-semibold w-24"
                    >Nombre</label
                  >
                  <input

                    pInputText
                    id="name"
                    class="flex-auto"
                    autocomplete="off"
                    formControlName="name"
                  />
                </div>
                <div class="flex items-center gap-4 mb-4">
                  <label for="price" class="font-semibold w-24"
                    >Descripcion</label
                  >
                  <input
                    pInputText
                    id="price"
                    class="flex-auto"
                    autocomplete="off"
                    formControlName="description"
                  />
                </div>
                <div class="flex items-center gap-4 mb-4">
                  <label for="category" class="font-semibold w-24"
                    >Categoría</label
                  >
                  <p-select
                    id="category"
                    [options]="categories"
                    name="Categoría"
                    placeholder="Selecciona una Categoría"
                    class="w-[69%]"
                    formControlName="category"
                  />
                </div>
                <div class="flex items-center gap-4 mb-4">
                  <label for="price" class="font-semibold w-24">Estado</label>
                  <p-select
                    [options]="states"
                    placeholder="Estado del Producto"
                    class="w-[69%]"
                    formControlName="status"
                  />
                </div>
                <div class="flex items-center gap-4 mb-8">
                  <label for="price" class="font-semibold w-24">Precio</label>
                  <input
                    pInputText
                    id="price"
                    class="flex-auto"
                    autocomplete="off"
                    formControlName="price"
                  />
                </div>
                <div class="flex justify-end gap-2">
                  <p-button
                    label="Cancelar"
                    severity="secondary"
                    (click)="visible = false"
                  />
                  <p-button type="submit" label="Actualizar" />
                </div>
              </form>
            </p-dialog>
          </div>
          } @else {
          <span class="text-2xl font-semibold text-red-600">VENDIDO</span>
          }
        </div>
      </div>
    </div>
    }
  </div>
</div>
